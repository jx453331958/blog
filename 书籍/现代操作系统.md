# 现代操作系统

## 第1章 引论

1. 现代计算机系统由一个或多个处理器、内存、磁盘、打印机、键盘、鼠标、显示器、网络接口以及各种其他输入/输出设备组成。
2. 操作系统的任务是为用户程序提供一个更好、更简单、更清晰的计算机模型，并管理上述设备。
3. 用户与操作系统交互的程序，基于文本的通常成为shell，而基于图标的则成为图形用户界面（GUI）。
4. 多数计算机有两种运行模式：内核态和用户态。
5. 软件中最基础的部分是操作系统，它运行在内核态。在这个模式中，操作系统具有对所有硬件的完全访问权，可以执行机器能够运行的任何指令。软件的其余部分运行在用户态下。在用户态下，只使用了机器指令中的一个子集。
6. 资源管理包括用以下两种不同方式实现多路复用（共享）资源：在时间上复用和在空间上复用。
    - 在时间上复用：不同的程序或用户轮流使用它。例如若系统中只有一个CPU，而多个程序需要在该CPU上运行，操作系统则首先把该CPU分配给某一个程序，在他运行足够长的时间之后，另一个程序得到CPU，然后是下一个，如此进行下去，最终，轮到第一个程序再次运行。
    - 空间复用：每个客户都得到资源的一部分，从而取代了客户排队。例如，通常在若干运行程序之间分割内存，这样每一个运行程序都可同时入住内存。假设有足够的内存可以存放多个程序，那么在内存中同时存放若干个程序的效率，比把所有内存都分给一个程序的效率要高得多。有关空间复用的其他资源还有磁盘。
7. 操作系统的历史：
    1. 第一代：真空管和穿孔卡片
    2. 第二代：晶体管和批处理程序
    3. 第三代：集成电路芯片和多道程序设计
    4. 第四代：个人计算机
8. 计算机硬件：
    1. CPU：从内存中取出指令并执行。在每个CPU基本周期中，首先从内存取出指令，解码以确定其类型和操作数，接着执行，然后取指、解码并执行下一条命令。
        - 每个CPU都有一套可执行的专门指令集。
        - CPU内部有用来保存关键变量和临时数据的寄存器。
        - 程序计数器寄存器：保存了将要取出的下一条指令的内存地址，在指令取出之后，程序计数器就被更新以便指向后继的指令。
        - 堆栈指针寄存器：指向内存中当前栈的顶端。保存了有关的输入参数、局部变量以及那些没有保存在寄存器中的临时变量。
        - 程序状态字寄存器：这个寄存器包含了条件码位、CPU优先级、模式（用户态或内核态），以及各种其他控制位。
        - 流水线设计，CPU具有同时取出多条指令的机制：一个CPU可以有分开的取指单元、解码单元和执行单元，于是当它执行指令n时，它还可以对指令n+1解码，并且读取指令n+2。
        - 超标量CPU，比流水线更先进的设计：在这种设计中，拥有多个执行单元，例如一个CPU用于整数算术运算，一个CPU用于浮点算术运算，另一个用于布尔运算。两个或更多的指令被同时取出、解码并装入一个保持缓冲区中，直至它们执行完毕。
    2. 存储器：存储器系统采用一种分层次的结构，寄存器、高速缓存、内存、磁盘、磁带，顶层的存储器速度较高，容量较小，与底层的存储器相比每位成本较高。
        - 存储器系统的顶层是CPU中的寄存器。它们用与CPU相同的材料制成，所以和CPU一样快。
        - 下一层是高速缓存，它多数由硬件控制。
        - 主存：通常被成为随机访问存储器（RAM）
        - 非易失性随机访问存储器：在电源切断之后，不会丢失内容，ROM
        - EEPROM：电可擦除可编程ROM。