# HTTP 权威指南

## 第 1 章 HTTP 概述

1. HTTP 使用的是可靠的数据传输协议，因此即使数据来自地球的另一端，它也能够确保数据在传输的过程中不会被损坏或产生混乱。
2. Web 服务器是 Web 资源的宿主。Web 资源是 Web 内容的源头，最简单的 Web 资源就是 Web 服务器文件系统中的静态文件。这些文件可以包含任意内容：文本文件、HTML 文件、微软的 Word 文件、JPEG 图片文件等。
3. 因特网上有数千种不同的数据类型，HTTP 仔细地给每种要通过 Web 传输的对象都打上了名为 MIME 类型的数据格式标签。最初设计 MIME（多用途因特网邮件扩展）是为了解决在不同的电子邮件系统之间搬移报文时存在的问题。MIME 在电子邮件系统中工作的非常好，因此 HTTP 也用它来描述并标记多媒体内容。
4. MIME 类型是一种文本标记，表示一种主要的对象类型和一个特定的子类型，中间由一条斜杠来分隔。
    1. HTML 格式的文本文档由 text/html 类型来标记
    2. 普通的 ASC2 文本文档由 text/plain 类型来标记
    3. JPEG 格式的图片为 image/jpeg 类型
    4. GIF 格式的图片为 image/gif 类型
5. 服务器资源名被称为统一资源标识符（Uniform Resource Identifier, URI）
6. 统一资源定位符（URL）是资源标识符最常见的形式。URL 描述了一台特定服务器上某资源的特定位置。它们可以明确说明如何从一个精确、固定的位置获取资源。
7. 大部分 URL 都遵循一种标准格式，包含三个部分：

    1. URL 的第一部分被称为方案，说明了访问资源所使用的协议类型。这部分通常就是 HTTP 协议（http://）
    2. 第二部分给出了服务器的因特网地址
    3. 其余部分指定了 Web 服务器上的某个资源。几乎所有 URI 都是 URL

8. URN：URI 的第二种形式就是统一资源名（URN）。URN 是作为特定内容的唯一名称使用的，与目前的资源所在地无关。使用这些与位置无关的 URN，就可以将资源四处搬移。

9. 一个 HTTP 事务由一条（从客户端发往服务器的）请求命令和一个（从服务器发回客户端的）响应结果组成。这种通信是通过 HTTP 报文（HTTP message）的格式化数据块进行的。

10. 方法：HTTP 支持几种不同的请求命令，这些命令被称为 HTTP 方法（HTTP method）。每条 HTTP 请求报文都包含一个方法。这个方法会告诉服务器要执行什么动作。常见的 5 种 HTTP 方法：

    1. GET： 从服务器向客户端发送命名资源
    2. PUT：将来自客户端的数据存储到一个命名的服务器资源中去
    3. DELETE：从服务器中删除命名资源
    4. POST：将客户端数据发送到一个服务器网关应用程序
    5. HEAD：仅发送命名资源响应中的 HTTP 首部

11. 状态码：每条 HTTP 响应报文返回时都会携带一个状态码，状态码是一个三位数字的代码，告知客户端请求是否成功，或者是否需要采取其他行动，常见的几种状态码：

    1. 200：ok
    2. 302：临时重定向
    3. 404：没有找到这个资源

12. 报文：HTTP 报文是由一行一行的简单字符串组成的。HTTP 报文都是纯文本，不是二进制代码，所以人们可以很方便地对其进行读写。
13. 请求报文：从客户端发往服务器的 HTTP 报文称为请求报文。
14. 响应报文：从服务器发往客户端的报文称为响应报文。
15. HTTP 报文包括三个部分：

    1. 起始行：报文的第一行是起始行，在请求报文中用来说明要做些什么，在响应报文中说明出现了什么情况。
    2. 首部字段：起始行后面由零个或多个首部字段。每个首部字段都包含一个名字和一个值，为了便于解析，两者之间用冒号进行分隔。首部以一个空行结束，添加一个首部字段和添加一个新行一样简单。
    3. 主体：空行之后就是可选的报文主体了，其中包含了所有类型的数据。请求主体中包括了要发送给 Web 服务器的数据；响应主体中装载了要返回给客户端的数据。起始行和首部都是文本形式且都是结构化的，而主体则不同，主体中除了文本外还可以包含任意的二进制数据（比如图片、视频、音轨、软件程序）。

16. HTTP 是个应用层协议。HTTP 无需操心网络通信的具体细节，它把联网的细节都交给了通用、可靠的因特网传输协议 TCP/IP。
17. TCP 提供了：

    1. 无差错的数据传输
    2. 按序传输（数据总是会按照发送的顺序到达）
    3. 未分段的数据流（可以在任意时刻以任意尺寸将数据发送出去）

18. 因特网自身就是基于 TCP/IP 的，TCP/IP 是全世界的计算机和网络设备常用的层次化分组交换网络协议集。TCP/IP 隐藏了各种网络和硬件的特点及弱点，使各种类型的计算机和网络都能够进行可靠的通信。只要建立了 TCP 连接，客户端和服务器之间的报文交换就不会丢失、不会被破坏、也不会在接收时出现错序了。

19. 在 HTTP 客户端向服务器发送报文之前，需要用网际协议（Internet Protocol，IP）地址和端口号在客户端和服务器之间建立一条 TCP/IP 连接。

20. 域名（主机名）可以通过域名服务（Domain Name Service，DNS）的机制方便的将主机名转换为 IP 地址。

21. 基本的浏览器访问 HTML 文档步骤：

    1. 浏览器从 URL 中解析出服务器的主机名
    2. 浏览器将服务器的主机名转换成服务器的 IP 地址
    3. 浏览器将端口号（如果有的话）从 URL 中解析出来
    4. 浏览器建立一条与 Web 服务器的 TCP 连接
    5. 浏览器向服务器发送一条 HTTP 请求报文
    6. 服务器向浏览器回送一条 HTTP 响应报文
    7. 关闭连接，浏览器显示文档

22. Telnet 协议：Telnet 常用于远程终端会话，但它几乎可以连接所有的 TCP 服务器，包括 HTTP 服务器

23. 协议版本：

    1. HTTP/0.9：HTTP 的 1991 原型版本称为 HTTP/0.9。这个协议有很多严重的设计缺陷，只应该用于与老客户端的交互。HTTP/0.9 只支持 GET 方法，不支持多媒体内容的 MIME 类型、各种 HTTP 首部或者版本号。
    2. HTTP/1.0：第一个得到广泛应用的 HTTP 版本。HTTP/1.0 添加了版本号、各种 HTTP 首部、一些额外的方法，以及对多媒体对象 的处理。
    3. HTTP/1.0+：这是一个非正式的扩展版本，增加了许多特性，包括 keep-alive 连接、虚拟主机支持，以及代理连接支持等。
    4. HTTP/1.1：该版本重点关注的是校正 HTTP 设计中的结构性缺陷，明确语义，引入重要的性能优化错误，并删除一些不好的特性。
    5. HTTP-NG（又名 HTTP/2.0）：该版本是 HTTP/1.1 后继结构的原型建议，它重点关注的是性能的大幅优化，以及更强大的服务逻辑远程执行框架。

24. Web 的结构组件
    1. 代理：位于客户端和服务器之间的 HTTP 中间实体。接收所有客户端的 HTTP 请求，并将这些请求转发给服务器（可能会对请求进行修改之后转发）。
    2. 缓存：HTTP 的仓库，使常用页面的副本可以保存在离客户端更近的地方
    3. 网关：连接其他应用程序的特殊 Web 服务器，作为其他服务器的中间实体使用。通常用于将 HTTP 流量转换称其他的协议。网关接受请求时就好像自己是资源的源端服务器一样。客户端可能并不知道自己正在与一个网关进行通信。
    4. 隧道：对 HTTP 通信报文进行盲转发的特殊代理，通常用来在一条或多条 HTTP 连接上转发非 HTTP 数据，转发时不会窥探数据。HTTP 隧道的一种常见用途是通过 HTTP 连接承载加密的安全套接字层（SSL，Secure Sockets Layer）流量，这样 SSL 流量就可以穿过只允许 Web 流量通过的防火墙了。
    5. Agent 代理：发起自动 HTTP 请求的半智能 Web 客户端。例如：浏览器
