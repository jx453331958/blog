# 现代操作系统

## 第 3 章 存储管理

1. 操作系统中管理分层存储器体系的部分称为存储管理器。它的任务是有效地管理内存，即记录哪些内存是正在使用的，哪些内存是空闲的；在进程需要时为其分配内存，在进程使用完后释放内存。

2. 无存储器抽象

    1. 一个没有内存抽象的系统也不太可能具有线程抽象的功能。
    2. 没有内存抽象，同时运行多个程序也是可能的。操作系统只需要把当前内存中的所有内容保存到磁盘文件中，然后把下一个程序读入到内存中再运行即可。只要在某一个时间内存中只有一个程序，那么就不会发生冲突。
    3. 需要避免两个程序都引用绝对物理地址。每个程序都应该使用一套私有的本地地址来进行内存寻址。

3. 一种存储器抽象：地址空间
    1. 把物理地址暴露给进程会带来几个严重的问题：
        1. 如果用户程序可以寻址内存的每个字节，它们就可以很容易地破坏操作系统，从而使系统慢慢地停止运行。
        2. 使用这种模型，想要同时运行多个程序是很困难的。
    2. 要保证多个应用程序同时处于内存中并且不互相影响，则需要解决两个问题：保护和重定位。
    3. 地址空间是一个进程可用于寻址内存的一套地址集合。每个进程都有一个自己的地址空间，并且这个地址空间独立语其他进程的地址空间。
    4. 基址寄存器与界限寄存器：这个简单的解决办法使用一种简单的动态重定位。它所做的是简单的把每个进程的地址空间映射到物理内存的不同部分。
    5. 当使用基址寄存器和界限寄存器时，程序装载到内存中连续的空间位置且装载期间无需重定位。每次一个进程访问内存，取一条指令，读或写一个数据字，CPU硬件会把地址发送到内存总线前，自动把基址值加到进程发出的地址值上。同时，它检查程序提供的地址是否等于或大于界限寄存器里的值，如果访问的地址超过了界限，会产生错误并终止访问。
    6. 使用基址寄存器和界限寄存器是给每个进程提供私有地址空间的非常容易的方法，因为每个内存地址在送到内存之前，都会自动先加上基址寄存器的内容。
    7. 使用基址寄存器和界限寄存器重定位的缺点是，每次访问内存都需要进行加法和比较运算。比较可以做的很快，但是加法由于进位传递时间的问题，在没有使用特殊电路的情况下会显得很慢。
    8. 交换技术：
