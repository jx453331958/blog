# 鸟哥的Linux私房菜

## 第 11 章：认识与学习bash

1. 管理整个计算机硬件的其实是操作系统的内核，这个内核是需要被保护的，所以我们一般用户就只能通过shell来跟内核通信，以让内核达到我们想要达到的工作。
2. 变量内容可以用单引号或者双引号括起来，双引号内的特殊字符如$等，可以保有原本的特性，单引号内的特殊字符则为一般字符（纯文本）。
3. 在一串命令中，还需要通过其他的命令提供的信息，可以使用反引号`'命令'`或`$(命令)`
4. 取消变量的方法为使用`unset 变量名称`
5. 在变量的设置当中，单引号与双引号的用途有何不同？单引号与双引号的最大不同在于双引号仍然可以保有变量的内容，但单引号内仅能是一般字符，而不会有特殊符号。
6. 查看环境变量的命令：env或export
7. PATH: 执行文件查找的路径，目录与目录中间以冒号分隔
8. 用set命令查看所有变量，包括环境变量与自定义变量
9. $本身也是一个变量，这个代表的是目前这个shell的线程代号，即是所谓的PID(Process ID)
10. 环境变量与自定义变量的差异在于该变量是否会被子进程所继续引用。子进程会继承父进程的环境变量，子进程不会继承父进程的自定义变量。
11. 变量键盘读取命令：read
12. 声明变量类型：declare / typeset
13. 在默认情况下，bash对于变量有几个基本的定义：
    1. 变量类型默认为字符串，所以如果不指定变量类型，则1+2为一个字符串而不是计算式
    2. bash环境中的数值运算，默认最多仅能达到整数类型，所以1/3结果是0 
14. 数组的变量类型比较有趣的地方在于“读取”，一般来说，建议直接以${数组}的方式来读取，会比较正确无误
15. 与文件系统及程序的限制关系：ulimit

16. 变量内容的删除与替换：


| 变量设置方式                 | 说明                                                          |
| :--------------------------- | :------------------------------------------------------------ |
| `${变量#关键字}`             | 若变量内容从头开始的数据符合“关键字”，则将符合的最短数据删除  |
| `${变量##关键字}`            | 若变量内容从头开始的数据符合“关键字”，则将符合的最长数据删除  |
| `${变量%关键字}`             | 若变量内容从尾向前的数据符合“关键字”， 则将符合的最短数据删除 |
| `${变量%%关键字}`            | 若变量内容从尾向前的数据符合“关键字”， 则将符合的最长数据删除 |
| `${变量/旧字符串/新字符串}`  | 若变量内容符合“旧字符串”，则第一个旧字符串会被新字符串替换    |
| `${变量//旧字符串/新字符串}` | 若变量内容符合“旧字符串”，则全部旧字符串会被新字符串替换      |

17. 变量的测试与内容替换，减号“-”后面接的关键字可以给前面的变量赋默认值，即`new_var=${old_var-content}`，如果`old_var`没有值，则`content`被赋给`new_var`。

19. 变量设置方式：

|    变量设置方式    |     str没有设置     |    str为空字符串    | str已设置为非空字符串 |
| :----------------: | :-----------------: | :-----------------: | :-------------------: |
| `var=${str-expr}`  |     `var=expr`      |       `var=`        |      `var=$str`       |
| `var=${str:-expr}` |     `var=expr`      |     `var=expr`      |      `var=$str`       |
| `var=${str+expr}`  |       `var=`        |     `var=expr`      |      `var=expr`       |
| `var=${str:+expr}` |       `var=`        |       `var=`        |      `var=expr`       |
| `var=${str=expr}`  | `str=expr;var=expr` |   `str不变;var=`    |  `str不变;var=$str`   |
| `var=${str:=expr}` | `str=expr;var=expr` | `str=expr;var=expr` |  `str不变;var=$str`   |
| `var=${str?expr}`  | `expr输出至stderr`  |       `var=`        |       `var=str`       |
| `var=${str:?expr}` | `expr输出至stderr`  | `expr输出至stderr`  |       `var=str`       |

20. 命名别名与变量有什么不同？命名别名是新创一个新的命令，可以直接执行该命令的，至于变量则需要使用类似echo命令才能够调用变量的内容。
21. `!!`执行上一条命令，`!number`执行第number条命令，`!command`由最近的命令向前搜寻命令串开头为command的命令并执行。
22. 命令运行的顺序
    1. 以相对/绝对路径执行命令，例如"/bin/ls"或"./ls"；
    2. 由alias找到该命令来执行；
    3. 由bash内置的(builtin)命令来执行；
    4. 通过$PATH这个变量的顺序找到的第一个命令来执行；

23. login shell: 取得bash时需要完整的登录流程的，就称为login shell。
24. non-login shell: 取得bash接口的方法不需要重复登录的举动
25. 一般来说，login shell只会读取两个配置文件，/etc/profile和～/.bash_profile
26. /etc/profile: 这是系统整体的设置
27. ~/.bash_profile或~/.bash_login或~/.profile：属于用户个人配置
28. /etc/profile是每个用户登录取得bash时一定会读取的配置文件。这个文件设置的主要变量有：
    1. PATH: 会根据UID决定PATH变量要不要含有sbin的系统命令目录
    2. MAIL: 依据账号设置好用户的mailbox到/var/spool/mail/账号名
    3. USER: 根据用户的账号设置此变量的内容
    4. HOSTNAME: 根据主机的hostname命令决定此变量内容
    5. HISTSIZE: 历史命令记录条数

29. bash在读完了整体环境设置的/etc/profile并借此调用其他配置文件之后，接下来则是会读取用户的个人配置文件。在login shell的bash环境中，所读取的个人偏好文件主要有三个，~/.bash_profile、~/.bash_login、~/.profile。bash只会读取上面三个文件中的一个，而读取顺序则是按照上面的顺序。profile文件中会设置PATH这个变量。profile文件还会读取.bashrc文件的设置内容。bash配置文件的读入方式比较有趣，主要是通过一个命令"source"来读取的。login shell的读取流程，《鸟哥的linux私房菜》P323
30. source(读入环境配置文件的命令): 利用source或小数点(.)都可以将配置文件的内容读进目前的shell环境中。例如修改了.bashrc，那么不需要注销，立即执行 `source .bashrc`就可以将刚才新设置的内容读进目前的环境中。还有包括~/bash_profile以及/etc/profile的设置中，很多时候也都是利用到这个source(或小数点)的功能。
31. ~/.bash_logout：这个文件记录了当我注销bash后系统再帮我做完什么操作后才离开。
32. bash环境中的特殊符号：

|  符号   | 内容                                                  |
| :-----: | :---------------------------------------------------- |
|   `#`   | 注释符号                                              |
|   `\`   | 转义符号                                              |
|   `|`   | 管道                                                  |
|   `;`   | 连续命令执行分隔符，连续性命令的界定                  |
|   `~`   | 用户的主文件夹                                        |
|   `&`   | 使用变量前导符号                                      |
|   `!`   | 逻辑运算意义上的非                                    |
|   `/`   | 目录符号，路径分隔的符号                              |
| `>, >>` | 数据流重定向，输出导向，分别是“替换”与“累加”          |
| `<, <<` | 数据流重定向，输入导向                                |
|  `''`   | 单引号，不具有变量置换的功能                          |
|  `""`   | 双引号，具有变量置换的功能                            |
|   ``    | 反引号，两个反引号中间为可以先执行的命令，也可使用$() |
|  `()`   | 在中间为子shell的起始与结束                           |
|  `{}`   | 在中间为命令块的结合                                  |